<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Eric J. Ward, Sean C. Anderson, Mary E. Hunsicker, Mike A. Litzow, Luis A. Damiano, Mark D. Scheuerell, Elizabeth E. Holmes, Nick Tolimieri" />

<meta name="date" content="2021-05-25" />

<title>Estimating process trend variability with bayesdfa</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Estimating process trend variability with bayesdfa</h1>
<h4 class="author">Eric J. Ward, Sean C. Anderson, Mary E. Hunsicker, Mike A. Litzow, Luis A. Damiano, Mark D. Scheuerell, Elizabeth E. Holmes, Nick Tolimieri</h4>
<h4 class="date">2021-05-25</h4>



<p>A constraint of most DFA models is that the latent trends are modeled as random walks with fixed standard deviations (= 1). We can evaluate the ability to estimate these parameters in a Bayesian context below.</p>
<p>Let’s load the necessary packages:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(bayesdfa)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(rstan)</span>
<span id="cb1-5"><a href="#cb1-5"></a>chains =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>iter =<span class="st"> </span><span class="dv">10</span></span></code></pre></div>
<div id="case-1-unequal-trend-variability" class="section level2">
<h2>Case 1: unequal trend variability</h2>
<p>First, let’s simulate some data. We will use the built-in function <code>sim_dfa()</code>, but normally you would start with your own data. We will simulate 20 data points from 4 time series, generated from 2 latent processes. For this first dataset, the data won’t include extremes, and loadings will be randomly assigned (default).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>sim_dat &lt;-<span class="st"> </span><span class="kw">sim_dfa</span>(</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="dt">num_trends =</span> <span class="dv">2</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="dt">num_years =</span> <span class="dv">20</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="dt">num_ts =</span> <span class="dv">4</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>)</span></code></pre></div>
<p>We’ll tweak the default code though to model slightly different random walks, with different standard deviations for each trend. We’ll assume these standard deviations are 0.3 and 0.5, respectively.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>sim_dat<span class="op">$</span>x[<span class="dv">1</span>,] =<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="kw">ncol</span>(sim_dat<span class="op">$</span>x), <span class="dv">0</span>, <span class="fl">0.1</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a>sim_dat<span class="op">$</span>x[<span class="dv">2</span>,] =<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="kw">ncol</span>(sim_dat<span class="op">$</span>x), <span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>Looking at the random walks, we can see the 2nd trend (red dashed line) is more variable than the black line.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">matplot</span>(<span class="kw">t</span>(sim_dat<span class="op">$</span>x),</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Response&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Simulated data, from a model with 2 latent trends and no extremes.\label{fig:simulate-data-plot}" />
<p class="caption">
Simulated data, from a model with 2 latent trends and no extremes.
</p>
</div>
<p>Next, we’ll calculate the predicted values of each time series and add observation error</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>sim_dat<span class="op">$</span>pred =<span class="st"> </span>sim_dat<span class="op">$</span>Z <span class="op">%*%</span><span class="st"> </span>sim_dat<span class="op">$</span>x</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(sim_dat<span class="op">$</span>pred)) {</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(sim_dat<span class="op">$</span>pred)) {</span>
<span id="cb5-4"><a href="#cb5-4"></a>    sim_dat<span class="op">$</span>y_sim[i,j] =<span class="st"> </span>sim_dat<span class="op">$</span>pred[i,j] <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.1</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>  }</span>
<span id="cb5-6"><a href="#cb5-6"></a>}</span></code></pre></div>
<div id="candidate-models" class="section level3">
<h3>Candidate models</h3>
<p>Next, we’ll fit a 2-trend DFA model to the simulated time series using the <code>fit_dfa()</code> function. This default model fixed the variances of the trends at 1 – and implicitly assumes that they have equal variance.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>f1 &lt;-<span class="st"> </span><span class="kw">fit_dfa</span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="dt">y =</span> sim_dat<span class="op">$</span>y_sim, <span class="dt">num_trends =</span> <span class="dv">2</span>, <span class="dt">scale=</span><span class="st">&quot;zscore&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="dt">iter =</span> iter, <span class="dt">chains =</span> chains, <span class="dt">thin =</span> <span class="dv">1</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>r1 &lt;-<span class="st"> </span><span class="kw">rotate_trends</span>(f1)</span></code></pre></div>
<p>Next, we’ll fit the model with process errors being estimated – and assume unequal variances by trend.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>f2 &lt;-<span class="st"> </span><span class="kw">fit_dfa</span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="dt">y =</span> sim_dat<span class="op">$</span>y_sim, <span class="dt">num_trends =</span> <span class="dv">2</span>, <span class="dt">scale=</span><span class="st">&quot;zscore&quot;</span>, <span class="dt">estimate_process_sigma =</span> <span class="ot">TRUE</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="dt">equal_process_sigma =</span> <span class="ot">FALSE</span>,</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="dt">iter =</span> iter, <span class="dt">chains =</span> chains, <span class="dt">thin =</span> <span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>r2 &lt;-<span class="st"> </span><span class="kw">rotate_trends</span>(f2)</span></code></pre></div>
<p>Third, we’ll fit the model with process errors being estimated, unequal variances by trend, and not z-score the data (this is just a test of the scaling).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>f3 &lt;-<span class="st"> </span><span class="kw">fit_dfa</span>(</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="dt">y =</span> sim_dat<span class="op">$</span>y_sim, <span class="dt">num_trends =</span> <span class="dv">2</span>, <span class="dt">scale=</span><span class="st">&quot;center&quot;</span>, <span class="dt">estimate_process_sigma =</span> <span class="ot">TRUE</span>,</span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="dt">equal_process_sigma =</span> <span class="ot">FALSE</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="dt">iter =</span> iter, <span class="dt">chains =</span> chains, <span class="dt">thin =</span> <span class="dv">1</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>r3 &lt;-<span class="st"> </span><span class="kw">rotate_trends</span>(f3)</span></code></pre></div>
<p>Our fourth and fifth models will be the same as # 2 and # 3, but will estimate a single variance for both trends.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>f4 &lt;-<span class="st"> </span><span class="kw">fit_dfa</span>(</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="dt">y =</span> sim_dat<span class="op">$</span>y_sim, <span class="dt">num_trends =</span> <span class="dv">2</span>, <span class="dt">scale=</span><span class="st">&quot;zscore&quot;</span>, <span class="dt">estimate_process_sigma =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="dt">equal_process_sigma =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="dt">iter =</span> iter, <span class="dt">chains =</span> chains, <span class="dt">thin =</span> <span class="dv">1</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>)</span>
<span id="cb9-6"><a href="#cb9-6"></a>r4 &lt;-<span class="st"> </span><span class="kw">rotate_trends</span>(f4)</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>f5 &lt;-<span class="st"> </span><span class="kw">fit_dfa</span>(</span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="dt">y =</span> sim_dat<span class="op">$</span>y_sim, <span class="dt">num_trends =</span> <span class="dv">2</span>, <span class="dt">scale=</span><span class="st">&quot;center&quot;</span>, <span class="dt">estimate_process_sigma =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="dt">equal_process_sigma =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="dt">iter =</span> iter, <span class="dt">chains =</span> chains, <span class="dt">thin =</span> <span class="dv">1</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>)</span>
<span id="cb9-13"><a href="#cb9-13"></a>r5 &lt;-<span class="st"> </span><span class="kw">rotate_trends</span>(f5)</span></code></pre></div>
</div>
<div id="recovering-loadings" class="section level3">
<h3>Recovering loadings</h3>
<p>As a reminder, let’s look at the loadings from the original simulation model</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">print</span>(<span class="kw">round</span>(sim_dat<span class="op">$</span>Z,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,]  0.57  0.00
## [2,] -0.14  0.33
## [3,]  1.18  1.06
## [4,] -1.52 -0.30</code></pre>
<p>The estimated loadings from the DFA where the trends are forced to have the same fixed variance are good</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">print</span>(<span class="kw">round</span>(r1<span class="op">$</span>Z_rot_mean,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>##        [,1]    [,2]
## [1,] -91.70  -32.20
## [2,] -10.27 -109.07
## [3,]  42.34  -12.66
## [4,] -28.00   -7.90</code></pre>
<p>but some of the loadings are far off. These loadings are also not well estimated for either of the models that estimate the process variances,</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">print</span>(<span class="kw">round</span>(r2<span class="op">$</span>Z_rot_mean,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>##        [,1]    [,2]
## [1,] -70.20   68.36
## [2,] -14.61 -118.64
## [3,] -66.64    9.32
## [4,] -47.34  -10.62</code></pre>
<p>or</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">print</span>(<span class="kw">round</span>(r3<span class="op">$</span>Z_rot_mean,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>##         [,1]   [,2]
## [1,]  -92.62  37.23
## [2,] -100.07 -64.45
## [3,]   -3.13 -44.88
## [4,]  -83.12 -29.19</code></pre>
<p>The loadings for Model 4 are given by</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">print</span>(<span class="kw">round</span>(r4<span class="op">$</span>Z_rot_mean,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>##        [,1]   [,2]
## [1,] -99.51   5.65
## [2,]  -7.46 -98.49
## [3,]   8.32   2.71
## [4,]   1.16   0.06</code></pre>
<p>and Model 5 by</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">print</span>(<span class="kw">round</span>(r5<span class="op">$</span>Z_rot_mean,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>##        [,1]    [,2]
## [1,] -89.54  -26.98
## [2,] -19.58 -107.16
## [3,]  44.17   66.35
## [4,] -47.99  -90.43</code></pre>
<p>If we calculate the RMSE of the different models, model # 3 (estimated process trends, raw data not standardized) performs the best</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">RMSE-loadings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">24263.24</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">30917.61</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">33873.93</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">19927.94</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">37172.58</td>
</tr>
</tbody>
</table>
</div>
<div id="recovering-trends" class="section level3">
<h3>Recovering trends</h3>
<p>Let’s do the same kind of summary with the trends</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">RMSE-trends</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">321.8506</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">199.0063</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">311.6231</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">128.4473</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">320.6021</td>
</tr>
</tbody>
</table>
<p>These show that model 3 (trend variances are estimated, with data not standardized) performs best</p>
</div>
<div id="summary" class="section level3">
<h3>Summary</h3>
<p>In this example, the estimation model that treated the variances of the random walks as parameters performed better than models that didn’t. A caveat is that we simulated the random walk variances to be an order of magnitude difference between the 2 trends, more similar trends would need additional simulations and more thorough validation studies. Similarly, we found that not standardizing the raw time series data (instead, just centering each time series) yielded estimates of the loadings and estimated trends that were more similar to those in the simulation model. Standardizing each time series a priori yields slightly worse estimates of the trends and loadings (comparing models 2 v 3 and 4 v 5).</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
